{
  "openapi": "3.0.3",
  "info": {
    "title": "Prophecy Secrets API",
    "description": "API for managing Prophecy secrets",
    "version": "1.0.0"
  },
  "components": {
    "parameters": {
      "X-AUTH-TOKEN": {
        "name": "X-AUTH-TOKEN",
        "in": "header",
        "description": "Prophecy authentication token. Required for all API requests.",
        "required": true,
        "schema": {
          "type": "string"
        }
      }
    }
  },
  "paths": {
    "/api/orchestration/fabric/{fabricId}/secret": {
      "parameters": [
        {
          "name": "fabricId",
          "in": "path",
          "description": "The unique ID of the parent fabric",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": ["Secret endpoints"],
        "summary": "List secrets per fabric",
        "operationId": "listSecretsByFabric",
        "parameters": [
          {
            "$ref": "#/components/parameters/X-AUTH-TOKEN"
          }
        ],
        "responses": {
          "200": {
            "description": "A list of fabric secrets",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["success"],
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Indicates the request was successful.",
                      "enum": [true]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "secrets": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "kind": {
                                "type": "string",
                                "description": "Secret kind (e.g., 'prophecy')."
                              },
                              "subKind": {
                                "type": "string",
                                "description": "Secret sub-type (e.g., 'text', 'm2m')."
                              },
                              "properties": {
                                "type": "object",
                                "properties": {
                                  "id": {
                                    "type": "string",
                                    "description": "The unique identifier for the secret."
                                  },
                                  "name": {
                                    "type": "string",
                                    "description": "The key name for the secret."
                                  }
                                }
                              },
                              "type": {
                                "type": "string",
                                "description": "The type of the resource (e.g., 'secret')."
                              }
                            }
                          },
                          "description": "Array of secret objects."
                        }
                      },
                      "description": "Response data containing the list of secrets."
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "secrets": [
                      {
                        "kind": "prophecy",
                        "subKind": "text",
                        "properties": {
                          "id": "4656",
                          "name": "accounttest"
                        },
                        "type": "secret"
                      },
                      {
                        "kind": "prophecy",
                        "subKind": "text",
                        "properties": {
                          "id": "4657",
                          "name": "bq_service_account_2"
                        },
                        "type": "secret"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Secret endpoints"],
        "summary": "Add secret to fabric",
        "operationId": "createSecret",
        "parameters": [
          {
            "$ref": "#/components/parameters/X-AUTH-TOKEN"
          }
        ],
        "requestBody": {
          "description": "Secret object to be created. Properties vary per secret type (subKind).",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["kind", "subKind", "properties"],
                "properties": {
                  "kind": {
                    "type": "string",
                    "description": "Secret kind. Must be `prophecy`."
                  },
                  "subKind": {
                    "type": "string",
                    "description": "Secret sub-type (e.g., 'text', 'm2m'). Secret properties vary by subKind. Refer to the orchestration API in the networks tab for specific property schemas."
                  },
                  "properties": {
                    "type": "object",
                    "description": "Secret properties that vary by subKind. The schema is specification-driven and depends on the subKind value. Refer to the orchestration API documentation for property schemas specific to each secret type.",
                    "additionalProperties": true,
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "The key name for the secret."
                      },
                      "value": {
                        "type": "string",
                        "description": "The secret value. For complex values like service account keys, this may be a JSON string."
                      }
                    }
                  }
                }
              },
              "example": {
                "subKind": "text",
                "properties": {
                  "name": "your-secret-name",
                  "value": "your-secret-value"
                },
                "kind": "prophecy"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Secret created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["success"],
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Indicates the request was successful.",
                      "enum": [true]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "The unique identifier for the created secret."
                        }
                      },
                      "description": "Response data containing the secret ID."
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "id": "4657"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/orchestration/fabric/{fabricId}/secret/id/{secretId}": {
      "parameters": [
        {
          "name": "fabricId",
          "in": "path",
          "description": "The unique ID of the parent fabric",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "secretId",
          "in": "path",
          "description": "The unique ID of the secret",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": ["Secret endpoints"],
        "summary": "Retrieve secret details",
        "operationId": "getSecretById",
        "parameters": [
          {
            "$ref": "#/components/parameters/X-AUTH-TOKEN"
          }
        ],
        "responses": {
          "200": {
            "description": "Secret resource found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["success"],
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Indicates the request was successful.",
                      "enum": [true]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "kind": {
                          "type": "string",
                          "description": "Secret kind (e.g., 'prophecy')."
                        },
                        "subKind": {
                          "type": "string",
                          "description": "Secret sub-type (e.g., 'text', 'm2m')."
                        },
                        "properties": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "description": "The unique identifier for the secret."
                            },
                            "name": {
                              "type": "string",
                              "description": "The key name for the secret."
                            }
                          }
                        },
                        "type": {
                          "type": "string",
                          "description": "The type of the resource (e.g., 'secret')."
                        }
                      },
                      "description": "Response data containing the secret details."
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "kind": "prophecy",
                    "subKind": "text",
                    "properties": {
                      "id": "4656",
                      "name": "accounttest"
                    },
                    "type": "secret"
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Secret endpoints"],
        "summary": "Update secret",
        "operationId": "updateSecret",
        "parameters": [
          {
            "$ref": "#/components/parameters/X-AUTH-TOKEN"
          }
        ],
        "requestBody": {
          "description": "Secret object with updated fields. All fields are required.",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["kind", "subKind", "properties"],
                "properties": {
                  "kind": {
                    "type": "string",
                    "description": "Secret kind. Must be `prophecy`."
                  },
                  "subKind": {
                    "type": "string",
                    "description": "Secret sub-type (e.g., 'text', 'm2m')."
                  },
                  "properties": {
                    "type": "object",
                    "required": ["name", "value"],
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "The key name for the secret."
                      },
                      "value": {
                        "type": "string",
                        "description": "The secret value. For complex values like service account keys, this may be a JSON string."
                      }
                    }
                  }
                }
              },
              "example": {
                "kind": "prophecy",
                "subKind": "text",
                "properties": {
                  "name": "bq_service_account_WOOOOO",
                  "value": "dummyyyyyyyy"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Secret updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["success"],
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Indicates the request was successful.",
                      "enum": [true]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "The unique identifier for the updated secret."
                        }
                      },
                      "description": "Response data containing the secret ID."
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "id": "4656"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Secret update failed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["success", "message"],
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Indicates the request failed.",
                      "enum": [false]
                    },
                    "message": {
                      "type": "string",
                      "description": "Error message describing why the request failed."
                    }
                  }
                },
                "example": {
                  "success": false,
                  "message": "Update Secret failed due to : Secret Store not found for Secret ID: propcy"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Secret endpoints"],
        "summary": "Delete secret",
        "operationId": "deleteSecret",
        "parameters": [
          {
            "$ref": "#/components/parameters/X-AUTH-TOKEN"
          }
        ],
        "responses": {
          "200": {
            "description": "Secret deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["success"],
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "description": "Indicates the request was successful.",
                      "enum": [true]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "The unique identifier for the deleted secret."
                        }
                      },
                      "description": "Response data containing the secret ID."
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "id": "4656"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
